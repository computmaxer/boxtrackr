{% extends "base.html" %}

{% block title %}My Packages{% endblock %}

{% block header %}
    <div class="offset2">
        <span style="margin-left: -30px;">My Packages</span>
    </div>
{% endblock %}

{% block content %}

    <div class="row">
        <div class="span8 offset2">

            <div class="package-list">
                <div class="header">
                    <div class="packages-summary">You have {{ num_packages }} packages.</div>
                    <a id="add-package-button" href="#add-package-modal" class="btn pull-right" style="margin-top: 6px;margin-right: 5px;text-align:left;font-weight:normal;" role="button" data-toggle="modal"><i class="icon-plus"></i><span class="btn-text">&nbsp; Add Package</span></a>
                </div>
            {% for package in packages %}
                <div id="package-{{ package.key() }}" class="package{% if loop.last %} last{% endif %}">
                    <div class="summary">
                        <div class="summary-row">
                            <div class="name">{{ package.name }}</div>
                            <div class="site">{{ package.site }}</div>
                            <div class="status">{{ package.STATUS_TEXT }}</div>
                        </div>
                        <div class="summary-row">
                            <div class="tracking-number">
                                <a href="#" class="hover-link" target="_blank" title="Open tracking information on carrier's website.">
                                    {{ package.tracking_number }}
                                </a>
                            </div>
                            <div class="description">{{ package.description }}</div>
                        </div>
                    </div>
                    <div class="details">

                    </div>
                </div>
            {% else %}
                <span>There are no package here!</span>
            {% endfor %}
            </div>

        </div>
    </div>

    <div class="modal" id="add-package-modal" tabindex="-1" role="dialog" aria-labelledby="add-package-modal" aria-hidden="true" style="display: none;">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
            <h3 id="myModalLabel">Add Package</h3>
        </div>
        <form id="add_package" class="form-horizontal modal-form" action='' method="POST">
            <div class="modal-body">
                <div>
                    {{ render_form(form) }}
                </div>
            </div>
            <div class="modal-footer">
                <input type="submit" class="btn btn-info" value="Submit" />
                <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
            </div>
        </form>
    </div>

    <script type="text/javascript">
        $(document).ready(function(){
        {% if add_package_open %}
            $('#add-package-button').trigger('click');
        {% endif %}
            $("#add-package-button").hover(function(){
                var that = $(this);
                that.stop();
                that.animate({width: 106}, 250, function(){
                    that.find('.btn-text').fadeIn(150);
                });
            }, function(){
                var that = $(this);
                that.stop();
                $('.btn-text', this).fadeOut(150, function(){
                    that.animate({width: 10}, 250);
                });

            });

        });

    </script>

{% endblock %}